# 16장 SerialDate 리펙터링

# SerialDate란?

- JCommon 라이브러리의 [org.jfree.date](http://org.jfree.date) 패키지 내에 있는 클래스
- 날짜를 표현하는 자바 클래스
- 시간 기반 날짜가 아닌 순수 날짜 클래스

## 1. 돌려보자

### SerialDate의 문제

1. 코드 안에 있는 테스트 케이스가 모든 경우를 점검하지 않는다

    → 클로버(코드 커버리지 도구)에 따르면 실행가능한 185개 중 단위 테스트가 실행하는 문장은 91개 (50%)

    ⇒ 독자적인 단위 테스트 구현

2. 실패한 테스트 케이스가 주석으로 처리

    ⇒ 모든 테스트 케이스 통과하도록 수정

3. 버그 있음

    ⇒ 수정

## 2. 고쳐보자

참고 : 코드를 고칠 때마다 SerialDate에 있는 단위 테스트와 독자적으로 만든 단위 테스트를 실행하여 JCommon 프레임워크에서 사용해도 문제가 없도록 수정

1. 코드 주석에서 변경 이력 삭제

    ⇒ 소스 코드 제어 도구를 사용하기 때문

2. 2개 이상 동일한 패키지로 이루어진 import문을 * 처리

    ⇒ ?? 그 안에 많은 기능들이 있는데 고작 2개가 중복이라고 *처리를 하는 것이 효율적일까?

3. 주석의 형식을 맞춤
4. 클래스 이름에서 Serial을 제거

    → Serial이 들어간 이유는 일련번호를 사용하여 클래스를 구현하였기 때문

    ⇒ '일련번호'라는 용어는 정확하지 못하다 (상대 오프셋, 서수가 더 정확)

    → SerialDate라는 이름은 구현을 암시하는데 실상은 추상 클래스

    ⇒ 구현은 숨기는 편이 좋다. SerialDate 이름의 추상화 수준이 올바르지 못하다.

    1차 결론 : Date라는 이름이 더 좋다

    → Java에서 Date라는 클래스가 너무 많다. Day도 너무 많이 쓰인다

    2차 결론 : DayDate로 변경

5. 상수의 모음은 enum으로 변경
6. 직렬화 제어 변수 serialVersionUID는 모듈을 변경할 때마다 변수 값이 달라진다.

    → 문서에서는 직접 선언하라고 권장

    ⇒ 삭제하고 자동 제어로 변환 (당분간 삭제 ??)

7. 불필요한 주석 제거
8. 변수를 보다 연관성 있는 클래스로 이동
9. DayDateFactory에서 DayDate 생성하도록 수정

    → 부모클래스에서는 자식 클래스를 몰라야함

10. 사용하지 않는 변수, 함수 제거
11. 적절한 변수명으로 수정
12. 기본 생성자 제거

    → 컴파일러가 기본 생성

13. 불필요한 final 키워드 제거
14. 불필요하게 오버로딩된 메소드는 통합하고 기능이 많은 메서드는 분리
15. 기능이 커진 클래스는 모클래스와 밀접하더라도 분리
16. 메서드 인수가 플래그의 역할을 하는 것은 바람직하지 않음, 특히 출력형식을 선택하는 플래그는 가급적 피하는 것이 좋음

    → 메소드 분리

    ⇒ 안드로이드에서는 서버 플래그에 따라 다른 기능을 하는 경우가 많은데 이걸 다 호출하는 쪽에서 분기를 해야하는건가???

17. 서술적인 표현이 가능하다면 단일 라인으로 가독성 높임 (P.359)
18. 클래스 필드를 많이 사용하는 메서드라면 static이면 안됨

    → 인스턴스 메서드로 변경

19. 메서드의 패턴 맞춤 
20. 추상 메서드로 만들어야하는가 인스턴스 메서드로 만들어야하는가를 잘 고민해야함

    → 각 유관하는 클래스의 의존도에 따라 다름

21. 코드에 논리적 의존성이 있다면 물리적으로 의존되게 해야한다. (P.363)

이에 대한 요약이... P.365에 있다!?!?!?!
