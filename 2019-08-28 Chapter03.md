# 03. 함수

어떤 프로그램이든 가장 기본적인 단위가 함수이다. 이 장은 함수를 잘 만드는 법을 소개한다. 

다음 함수는 추상화 수준도 너무 다양하고, 길이가 길고, 중복된 코드가 있고, 괴상한 문자열에, 낯설고 모호한 자료 유형과 api가 많다.

40페이지 3-1

<br/>

## 작게 만들어라!

함수를 만드는 첫째 규칙은 작게다. 두번째 규칙은 더 작게다.

이 규칙은 근거를 대기가 곤란하다. 함수가 작을수록 더 좋다는 증거나 자료를 제시하기도 어렵다.

얼마나 짧아야 좋을까? 

중첩 구조가 생길만큼 함수가 커져서는 안된다. 

그러므로 들여쓰기 수준은 1단이나 2단을 넘어서면 안된다.

if, while등 들어가는 블록은 한줄이어야 한다.

<br/>

## 한 가지만 해라!

!! 깊게 이해 필요. !!

30여년간 다양한 표현으로 프로그래머들에게 주어진 충고이다.

**함수는 한 가지를 해야한다. 그 한가지를 잘 해야한다. 그 한가지만을 해야 한다.**

그 한가지란 무엇인가.

한가지만 하는지 판단하는 방법

1. 지정된 함수 이름 아래에서 추상화 수준이 하나인 단계만 수행한다면 그 함수는 한 가지 작업만 한다.

2. 단순히 다른 표현이 아니라 의미 있는 이름으로 다른 함수를 추출할 수 있다면 그 함수는 여러 작업을 하는 셈이다.

<br/>

## 함수 당 추상화 수준은 하나로!

!! 더 읽어보자 !!

한 함수 내에 추상화 수준을 섞으면 코드를 읽는 사람이 헷깔린다. 문제는 깨어진 창문처럼 사람들이 함수에 세부사항을 점점 더 추가한다.

**위에서 아래로 코드 읽기 : 내려가기 규칙**

<br/>

## Switch 문

Switch문은 작게 만들기 어렵다. 본질적으로 switch문은 N가지를 처리한다.

완전히 피할 방법은 없지만 switch 문을 다형성을 이용하여 저차원 클래스에 숨기고 절대로 반복하지 않는 방법이 있다.

인터페이스, 팩토리, 구현까지 다 만들어서까지 처리해야 할까? 실업무에는 어떤 스위치 문이 있는지 한번 봐야겠다.

<br/>

## 서술적인 이름을 사용하라

이름이 길어도 괜찮다. 

이름을 붙일 때는 일관성이 있어야 한다. 

includeSetupAndTeardownPages, includeSetupPages, includeSuiteSetupPage 등이 좋은 예이다.

<br/>

## 함수 인수

이상적인 인수 개수는 0개이다. 다음은 1개이고 다음은 2개이다 3개 이상은 피하자, 4개는 절대 안된다.

테스트 관점에서도 인수가 많을수록 갖가지 조합을 해야해서 부담이 된다.

좋은 예는 다음과 같다.

`SetupTeardownIncluder.render(pageData)`

<br/>

### 많이 쓰는 단항 형식

1. 질문을 던지는 경우

    boolean fileExistes(file)

2. 변환하여 결과를 반환하는 경우

    InputStream fileOpen(file)

위 경우가 아니라면 단항 함수는 가급적 피한다.

예를들어 includeSetupPageInto(StringBuffer pageText)처럼 변환 함수에서 입력 인수를 사용하면 혼란을 일으킨다.

? 그럼  파일 여는거 한줄도 함수로 뺴야하나 ? 

<br/>

### 플래그 인수

함수로 부울값을 넘기는 것은 좋지 않다. 함수에서 해당 부울값을 이용하여 두가지 동작을 한다고 표현하는 것이나 마찬가지이다.

원래는 renderForSuite와 renderForSingleTest로 함수를 나누는 것이 마땅하다.

? 이해가 잘 안된다.

<br/>

### 이항 함수

이항 함수가 적절한 경우는 많지 않다. Point처럼 좌표에는 두개의 숫자를 필요로 하는 경우이다.

writeField(outputstream, name)과 같은 경우

outputstream 클래스 구성원으로 만들던가 ouputstream을 구성원으로 만들어 인수로 넘기지 않아야 한다.

<br/>

### 동사와 키워드

단항 함수는 함수와 인수가 동사 / 명사 쌍을 이뤄야 한다.

write(name) 이 될 수 있고, writeField(name)이 조금 더 좋은 표현이다.

마지막 예로는 함수 이름에 키워드를 추가하는 형식이다.

assertExpectedEqualsActual(expected, actual)

?Kotlin에서도 필요할까?

<br/>

## 부수 효과를 일으키지 마라.

때로는 예상치 못하게 클래스 변수를 수정한다. 

checkPassword라는 함수 내에서 세션을 초기화 한다고 하면 옳지 못하다.

정 시간이 없을 경우 한가지만 한다는 규칙을 해결하지는 못하지만 함수 이름을 checkPasswordAndInitializeSession으로 하는것이 낫다.

<br/>

### 출력 인수

일반적으로 출력 인수는 피해야 한다. 함수에서 상태를 변경해야 한다면 함수가 속한 객체 상태를 변경하는 방식을 택하자.

<br/>

## 명령과 조회를 분리하라.

함수는 뭔가를 수행하거나 뭔가에 답하거나 둘 중 하나만 해야한다. 둘 다 하면 안된다.

<br/>

## 오류 코드보다 예외를 사용하라

자칫하면 if문에서 표현식으로 사용하기 쉽다.

58 페이지

오류 코드 대신 예외를 사용하면 오류 처리 코드가 원래 코드에서 분리되므로 코드가 깔끔해진다.

<br/>

### Try/Catch 블록 뽑아내기

코드 구조에 혼란을 일으키며 정상 동작과 오류 처리 동작을 뒤섞는다.

? 그럼 하위 함수로 모두 throws를 넣어야 하는데 괜찮을까?

<br/>

### Error.java 의존성 자석

오류코드를 반환한다는 것은 어디선가 오류 코드를 정의한다는 뜻이다. Error Class는 변경이 어려워지고 번거롭기 때문에 Exception에서 파생되는 예외 클래스를 사용하자

<br/>

## 반복하지 마라.(중복 코드를 없애자)

중복 코드는 길이가 늘어날 뿐 아니라 알고리즘이 변하면 네군데 모두 변경해야 한다.

<br/>

## 함수를 어떻게 짜죠?

처음부터 완변하게 짜여질 순 없다.

들여쓰기가 많아지고 중복 코드도 있을것이다. 후에 하나씩 정리하는 방식으로 진행해도 좋다.

<br/>

## 결론

진정한 목표는 우리가 작성하는 함수가 분명하고 정확한 언어로 깔끔하게 하여 시스템이라는 이야기를 풀어나가는 것이다.